@{
    Layout = "~/Views/Shared/Admin_Layout.cshtml";
    ViewData["Title"] = "Events";
    ViewData["Subtitle"] = "Manage Community Events";
}

<link rel="stylesheet" href="~/css/admin/events.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<div class="events-container">
    <div class="events-header">
        <div class="event-action-buttons" style="display: flex; gap: 5rem;">
            <button class="btn-add-event" id="addEventBtn">
                <i class="fas fa-plus"></i> <span class="btn-text">Add New Event</span>
            </button>
            <button class="btn-view-toggle" id="viewToggleBtn">
                <i class="fas fa-users"></i> <span class="btn-text">Show Participants</span>
            </button>
        </div>
    </div>

    <!-- Participants Table Section (Initially hidden) -->
    <div class="events-table-section" id="eventsTableSection" style="display: none;">
        <div class="table-header">
            <h3>Event Participants</h3>
            <div class="table-controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search participants..." id="eventsSearch">
                </div>
                <button class="btn-refresh" id="refreshEvents">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>
        <div class="events-table-container">
            <table class="events-table" id="eventsTable">
                <tbody>
                    <!-- Participants will be loaded here by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Calendar and Upcoming Events Section (Initially shown) -->
    <div class="events-content" id="eventsContent">
        <!-- Calendar Section -->
        <div class="calendar-section">
            <div class="calendar-header">
                <button class="calendar-nav" id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                <h2 id="currentMonthYear">March 2023</h2>
                <button class="calendar-nav" id="nextMonth"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="calendar-grid" id="calendarGrid">
                <!-- Calendar will be generated by JavaScript -->
            </div>
        </div>

        <!-- Events List Section -->
        <div class="events-list-section">
            <div class="events-list-header">
                <h3>Upcoming Events</h3>
                <div class="view-options">
                    <button class="view-option" data-view="grid" title="Grid view"><i class="fas fa-th-large"></i> <span class="view-text">Grid</span></button>
                </div>
            </div>
            
            <div class="events-list" id="eventsList">
                <!-- Events will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- Event Modal -->
<div class="modal" id="eventModal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3 id="modalTitle">Add New Event</h3>
        <form id="eventForm">
            <div class="form-group">
                <label for="eventTitle">Event Title</label>
                <input type="text" id="eventTitle" placeholder="Enter event title" required>
            </div>
            
            <div class="form-group">
                <label for="eventImage">Event Image URL</label>
                <input type="url" id="eventImage" placeholder="https://example.com/image.jpg">
                <small>Or upload an image:</small>
                <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                <button type="button" class="btn-upload" onclick="document.getElementById('imageUpload').click()">
                    <i class="fas fa-cloud-upload-alt"></i> Upload Image
                </button>
                <div class="image-preview" id="imagePreview" style="display: none;">
                    <img id="previewImage" src="#" alt="Preview" style="max-width: 100%; max-height: 150px;">
                    <button type="button" class="btn-remove-image" onclick="removeImage()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="eventDate">Date</label>
                    <input type="date" id="eventDate" required>
                </div>
                <div class="form-group">
                    <label for="startTime">Start Time</label>
                    <input type="time" id="startTime" required>
                </div>
                <div class="form-group">
                    <label for="endTime">End Time</label>
                    <input type="time" id="endTime" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="eventLocation">Location</label>
                <input type="text" id="eventLocation" placeholder="Enter location" required>
            </div>
            
            <div class="form-group">
                <label for="eventDescription">Description</label>
                <textarea id="eventDescription" rows="4" placeholder="Enter event description" required></textarea>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="eventCapacity">Maximum Capacity</label>
                    <input type="number" id="eventCapacity" min="1" value="50" required>
                </div>
                <div class="form-group">
                    <label for="eventOrganizer">Organizer</label>
                    <input type="text" id="eventOrganizer" placeholder="Event organizer">
                </div>
            </div>
            
            <div class="form-group">
                <label for="eventContact">Contact Email</label>
                <input type="email" id="eventContact" placeholder="contact@example.com">
            </div>
            
            <div class="form-group">
                <label>Tags</label>
                <div class="tag-options">
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="public"> Public
                    </label>
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="family"> Family
                    </label>
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="professional"> Professional
                    </label>
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="tech"> Technology
                    </label>
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="wellness"> Wellness
                    </label>
                    <label class="tag-option">
                        <input type="checkbox" name="tags" value="outdoor"> Outdoor
                    </label>
                </div>
            </div>
            
            <div class="form-group">
                <label class="featured-option">
                    <input type="checkbox" id="featuredEvent"> Featured Event
                </label>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn-cancel">Cancel</button>
                <button type="submit" class="btn-save">Save Event</button>
            </div>
        </form>
    </div>
</div>

<!-- Event Details Modal -->
<div class="modal" id="eventDetailsModal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <div class="event-details-content" id="eventDetailsContent">
            <!-- Event details will be loaded here -->
            
            <!-- Participants Section -->
            <div class="participants-section">
                <h4>Participants (<span id="participantCount">0</span>)</h4>
                <div class="participant-actions">
                    <button class="btn-add-participant" id="addParticipantBtn">
                        <i class="fas fa-user-plus"></i> Add Participant
                    </button>
                </div>
                <div class="participants-list" id="participantsList">
                    <!-- Participants will be loaded here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Participant Modal -->
<div class="modal" id="participantModal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Add Participant</h3>
        <form id="participantForm">
            <div class="form-group">
                <label for="participantType">Participant Type</label>
                <select id="participantType" required>
                    <option value="">Select type</option>
                    <option value="homeowner">Homeowner</option>
                    <option value="staff">Staff</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            
            <div class="form-group" id="homeownerSelectGroup" style="display: none;">
                <label for="homeownerSelect">Select Homeowner</label>
                <select id="homeownerSelect">
                    <!-- Will be populated by JavaScript -->
                </select>
            </div>
            
            <div class="form-group" id="staffSelectGroup" style="display: none;">
                <label for="staffSelect">Select Staff</label>
                <select id="staffSelect">
                    <!-- Will be populated by JavaScript -->
                </select>
            </div>
            
            <div class="form-group" id="adminSelectGroup" style="display: none;">
                <label for="adminSelect">Select Admin</label>
                <select id="adminSelect">
                    <!-- Will be populated by JavaScript -->
                </select>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn-cancel">Cancel</button>
                <button type="submit" class="btn-save">Add Participant</button>
            </div>
        </form>
    </div>
</div>

<script src="~/js/admin/event.js" asp-append-version="true"></script>