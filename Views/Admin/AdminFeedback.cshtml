@{
    Layout = "~/Views/Shared/Admin_Layout.cshtml";
    ViewData["Title"] = "Feedback";
    ViewData["Subtitle"] = "View User Feedback";
}

<link rel="stylesheet" href="~/css/admin/admin-feedback.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

<div class="feedback-admin-container">
    <div class="feedback-header">
    </div>

    <!-- Feedback Tabs -->
    <div class="feedback-tabs">
        <button class="tab-button active" data-tab="facility-feedback">Facility Feedback</button>
        <button class="tab-button" data-tab="service-complaints">Service Complaints</button>
    </div>

    <!-- Facility Feedback Section -->
    <section class="feedback-content active" id="facility-feedback">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-label">Total Feedback</span>
                <span class="stat-value">0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Average Rating</span>
                <span class="stat-value">0.0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">New This Week</span>
                <span class="stat-value">0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Facilities</span>
                <span class="stat-value">0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
        </div>

        <!-- Facility Filter -->
        <div class="card">
            <div class="card-header">
                <h2>Facility Feedback</h2>
                <div class="filter-controls">
                    <select id="facilityFilter" class="form-select">
                        <option value="all">All Facilities</option>
                        <option value="Function Hall">Function Hall</option>
                        <option value="Sports Court">Sports Court</option>
                        <option value="Swimming Pool">Swimming Pool</option>
                        <option value="Gym Facility">Gym Facility</option>
                    </select>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Facility</th>
                            <th>Rating</th>
                            <th>Feedback</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="7" class="text-center">
                                <div class="loading-state">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Loading feedback...</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="pagination">
                <!-- Pagination will be dynamically generated -->
            </div>
        </div>
    </section>

    <!-- Service Complaints Section -->
    <section class="feedback-content" id="service-complaints">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-label">Total Complaints</span>
                <span class="stat-value">0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Open Complaints</span>
                <span class="stat-value">0</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Avg Resolution Time</span>
                <span class="stat-value">0.0</span>
                <span class="stat-value" style="font-size: 1rem;">days</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Satisfaction Rate</span>
                <span class="stat-value">0%</span>
                <span class="stat-change">
                    <i class="fas fa-equals"></i> No change
                </span>
            </div>
        </div>

        <!-- Complaint Filter -->
        <div class="card">
            <div class="card-header">
                <h2>Service Complaints</h2>
                <div class="filter-controls">
                    <select id="statusFilter" class="form-select">
                        <option value="all">All Statuses</option>
                        <option value="open">Open</option>
                        <option value="in-progress">In Progress</option>
                        <option value="resolved">Resolved</option>
                    </select>
                    <select id="serviceTypeFilter" class="form-select">
                        <option value="all">All Service Types</option>
                        <option value="House Cleaning">House Cleaning</option>
                        <option value="Garden Maintenance">Garden Maintenance</option>
                        <option value="Handyman Services">Handyman Services</option>
                        <option value="Safety Inspection">Safety Inspection</option>
                    </select>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Service Type</th>
                            <th>Complaint</th>
                            <th>Severity</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Complaints will be dynamically loaded here -->
                    </tbody>
                </table>
            </div>
            
            <div class="pagination">
                <!-- Pagination will be dynamically generated -->
            </div>
        </div>
    </section>
</div>

<!-- Feedback Detail Modal -->
<div class="modal" id="feedbackDetailModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Feedback Details</h3>
            <span class="close">&times;</span>
        </div>
        <div class="modal-body">
            <div class="feedback-detail">
                <div class="feedback-user-detail">
                    <img src="" alt="User" class="detail-user-avatar" id="feedbackUserAvatar">
                    <div class="feedback-user-info">
                        <h4 id="feedbackUserName"></h4>
                        <p id="feedbackUserUnit"></p>
                    </div>
                </div>
                
                <div class="feedback-meta">
                    <div class="meta-item">
                        <span class="meta-label">Facility:</span>
                        <span class="meta-value" id="feedbackFacility"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Rating:</span>
                        <span class="meta-value" id="feedbackRating"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Date:</span>
                        <span class="meta-value" id="feedbackDate"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Status:</span>
                        <span class="meta-value" id="feedbackStatus"></span>
                    </div>
                </div>
                
                <div class="feedback-fulltext">
                    <h4>Full Feedback:</h4>
                    <p id="feedbackFullText"></p>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary close-modal">Close</button>
            <button class="btn btn-danger" id="deleteFeedbackBtn">
                <i class="fas fa-trash"></i> Delete Feedback
            </button>
            <button class="btn btn-primary" id="approveFeedbackBtn">
                <i class="fas fa-check"></i> Approve
            </button>
        </div>
    </div>
</div>

<!-- Complaint Detail Modal -->
<div class="modal" id="complaintDetailModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Complaint Details</h3>
            <span class="close">&times;</span>
        </div>
        <div class="modal-body">
            <div class="feedback-detail">
                <div class="feedback-user-detail">
                    <img src="" alt="User" class="detail-user-avatar" id="complaintUserAvatar">
                    <div class="feedback-user-info">
                        <h4 id="complaintUserName"></h4>
                        <p id="complaintUserUnit"></p>
                    </div>
                </div>
                
                <div class="feedback-meta">
                    <div class="meta-item">
                        <span class="meta-label">Service Type:</span>
                        <span class="meta-value" id="complaintServiceType"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Severity:</span>
                        <span class="meta-value" id="complaintSeverity"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Date:</span>
                        <span class="meta-value" id="complaintDate"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Status:</span>
                        <span class="meta-value" id="complaintStatus"></span>
                    </div>
                </div>
                
                <div class="feedback-fulltext">
                    <h4>Complaint Details:</h4>
                    <p id="complaintFullText"></p>
                </div>
                
                <div class="complaint-resolution" id="resolutionSection">
                    <h4>Resolution Notes:</h4>
                    <textarea id="resolutionNotes" class="form-control" rows="3" placeholder="Enter resolution details..."></textarea>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary close-modal">Close</button>
            <button class="btn btn-primary" id="resolveComplaintBtn">
                <i class="fas fa-check"></i> Mark as Resolved
            </button>
        </div>
    </div>
</div>

<script src="~/js/admin/feedback.js"></script>